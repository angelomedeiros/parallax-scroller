!function(e){var t={parallaxSpeed:3,tilt:false,parallaxOnMobile:true,startPosition:"0%",retainNativeScroll:true};e.fn.parallaxScroller=function(n){return this.each(function(){var r=e.extend({},t,n),i=e(this),s=0;i.addClass("ps-list").find(" > *").wrapAll("<div class='ps-scroller'></div>");i.find(" > .ps-scroller > *").each(function(){var t=e(this);t.addClass("ps-list-item").css({background:"url("+t.data("ps-bg")+") center center no-repeat","background-size":"100% auto","background-position":"50% "+r.startPosition});if(r.tilt!=false){t.css({"-webkit-transform":"matrix(1,"+r.tilt*.01+",0,1,0,0)","-moz-transform":"matrix(1,"+r.tilt*.01+",0,1,0,0)","-o-transform":"matrix(1,"+r.tilt*.01+",0,1,0,0)",transform:"matrix(1,"+r.tilt*.01+",0,1,0,0)"})}});if(r.retainNativeScroll==true){i.addClass("ps-native");i=e("body")}var o,u=false;if(settings.parallaxOnMobile==true){i.on("touchstart",function(){if(event.touches.length==1){o=event.touches[0].pageY;u=true}});i.on("touchend",function(){u=false;o=null})}i.find(".ps-list-item").each(function(){var t=e(this);i.on("touchmove mousewheel DOMMouseScroll",function(n){if(r.retainNativeScroll==true){s=e(document).scrollTop()}if(t.is_on_screen()){if(r.retainNativeScroll==true){var a=e(document).height()}else{var a=i.find(".ps-scroller").height()}if(s<a-i.height()&&s>0){var f=t.css("backgroundPosition").split(" "),l=s/(a-i.height())*100,c=-n.originalEvent.detail||n.originalEvent.wheelDelta;if(u==true){var h=event.touches[0].pageY,c=-1*(o-h)}if(c<0){l=Math.min(Math.max(parseFloat(f[1])+r.parallaxSpeed/5,parseFloat(r.startPosition)),100)}else{l=Math.min(Math.max(parseFloat(f[1])-r.parallaxSpeed/5,parseFloat(r.startPosition)),100)}var p="50% "+l+"%";t.css({"background-position":p})}}})});if(r.retainNativeScroll!=true){i.on("touchmove mousewheel DOMMouseScroll",function(e,t){var n=s;t=t||-e.originalEvent.detail/3||e.originalEvent.wheelDelta/120;if(u==true){var r=event.touches[0].pageY,t=o-r;if(Math.abs(t)>=30){n=Math.min(i.find(".ps-scroller").height()-i.height(),Math.max(0,parseInt(n-t/6*-1)));i.find(".ps-scroller").stop().animate({top:-1*n+"px"},0,"linear")}}else{n=Math.min(i.find(".ps-scroller").height()-i.height(),Math.max(0,parseInt(n-t*30)));i.find(".ps-scroller").stop().animate({top:-1*n+"px"},0,"linear")}s=n;e.stopPropagation();return false})}e.fn.is_on_screen=function(){var e=i;var t={top:s};t.bottom=t.top+e.height();var n=this.offset();if(r.retainNativeScroll==true){n.top=this.offset().top;n.bottom=this.offset().top+this.outerHeight()}else{n.top=this.offset().top-i.find(".ps-scroller").offset().top;n.bottom=this.offset().top-i.find(".ps-scroller").offset().top+this.outerHeight()+this.outerHeight()}return!(t.bottom<n.top||t.top>n.bottom-100)}})}}(window.jQuery)